---
showTableOfContents: true
title: "Deconstructing the Emotet C2 Protocol"
type: "page"
---
## Introduction

## Introduction

Emotet, first identified in 2014, has evolved significantly from its origins as a banking trojan into a premier Malware-as-a-Service (MaaS) infrastructure. Its primary function in the modern cybercrime ecosystem is to serve as a distribution network, providing initial access for other secondary payloads, including other banking trojans like TrickBot and Qakbot, and other precursors to ransomware attacks.

This report provides an exhaustive, network-centric analysis of the Emotet malware. The focus is exclusively on its "on-the-wire" characteristics: its command-and-control (C2) architecture, its communication protocols, and the network behaviours of its key modules. Endpoint artifacts and host-based indicators are deliberately omitted to serve the specific needs of network defenders, threat hunters, and intelligence analysts who are tasked with detecting and mitigating this threat at the network level.

The history of Emotet is marked by continuous evolution and a significant law enforcement takedown in January 2021, which serves as a critical demarcation point for analysis. This event, dubbed "Operation Ladybird," provided a temporary reprieve, but the botnet's re-emergence in late 2021 underscored the resilience of its design and the persistence of its operators.


## The Emotet C2 Infrastructure

### The Tiered Command Structure

Emotet's C2 architecture is not a flat hierarchy but a multi-tiered system that obfuscates the true location of its core control servers. This design creates significant redundancy and makes it  difficult for defenders to neutralize the entire botnet by targeting a few central points.

The infrastructure is primarily composed of three distinct tiers.

#### "Bot C2s" (Tier 1 Proxies - Infected Peers)

A crucial element of Emotet's resilience is its use of other infected victim machines as a foundational C2 layer. These "Bot C2s" are not dedicated servers but are regular computers compromised by Emotet that have been co-opted into the botnet's C2 fabric. They function as a vast, distributed network of proxies, relaying C2 traffic from newly infected bots toward the next tier.

[Analysis](https://blog.lumen.com/emotet-redux/) by Lumen's Black Lotus Labs revealed that at times, these Bot C2s, often located in dynamic broadband IP ranges across regions like Latin America, constituted over 80% of the active C2 IPs. Their ephemeral nature - constantly changing as machines are powered off or cleaned - makes traditional IP-based blocklisting an ineffective long-term strategy.

#### Tier 1 C2s (Tier 2 Proxies - Compromised Webhosts)
The next layer consists of legitimate but compromised web servers. These servers, often running common web server software like NGINX or Apache, act as a more stable, second layer of proxies. Their legitimate history and generally clean IP reputation help Emotet's initial communications blend in with normal web traffic, evading reputation-based security filters. Traffic from the Bot C2s is forwarded to these Tier 1 servers.


#### Tier 2 C2s (Core Controllers)
This is the command layer from where the actual operators manage their assets and issue commands. Traffic from both the Bot C2s and Tier 1 C2s is ultimately forwarded to these core servers.

Identifying these Tier 2 servers requires large-scale network traffic analysis, as defenders must trace the outbound communications from a large, distributed pool of Tier 1 proxies to find common destinations.

[Research](https://www.security.ntt/blog/behind-the-scenes-of-the-emotet-infrastructure) from NTT Security successfully employed this method, identifying Tier 2 servers by their common web server configurations (e.g., NGINX on port 80 and Apache on port 8080) that were receiving traffic from numerous Tier 1 proxies.

---
[|TOC|]({{< ref "../../malware/_index.md" >}})
[|PREV|]({{< ref "vpnfilter.md" >}})
[|NEXT|]({{< ref "vpnfilter.md" >}})
