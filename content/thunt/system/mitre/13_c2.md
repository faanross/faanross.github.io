---
showTableOfContents: true
title: "Using MITRE ATT&CK for Threat Hunting"
type: "page"
---




## Command and Control: Maintaining Communication

Command and control (C2) represents how adversaries communicate with compromised systems, send commands, and receive data. This includes direct connections, proxy chains, legitimate web services, DNS tunneling, encrypted HTTPS channels, and esoteric protocols.

**Threat Hunting Reality**: Excellent hunting opportunities with heavy network focus. C2 must communicate over your network, providing multiple detection opportunities through Zeek logs, NetFlow analysis, packet captures, and behavioral analytics. Zeek's protocol-specific logs (`dns.log`, `http.log`, `ssl.log`, `conn.log`) provide rich hunting data, while long-term flow analysis reveals beaconing patterns and anomalous connections.

DNS-based C2 reveals itself through query pattern analysis. Zeek's `dns.log` captures query characteristics - hunt for high-entropy subdomains (long, random-looking strings), excessive query volumes to single domains, or heavy use of TXT, MX, or NULL record types that can carry more data than standard A records. Look for consistent query intervals suggesting beaconing rather than normal irregular DNS patterns. Newly registered domains, obscure TLDs, or domains generating thousands of queries from single hosts warrant investigation.

HTTP/HTTPS C2 is prevalent due to blending with normal web traffic. Zeek's `http.log` reveals unusual User-Agent strings, uncommon HTTP methods (PUT, DELETE to suspicious endpoints), or regular POST requests with consistent sizes suggesting beaconing. Hunt for connections to non-standard ports (HTTP on port 8080, 8443) or web requests with suspicious URI patterns - long base64 strings, unusual parameter structures, or requests to `/admin`, `/api`, `/update`endpoints on non-legitimate domains. SSL certificate analysis through Zeek's `ssl.log` can identify self-signed certificates, certificates with suspicious subject names, or TLS connections to unusual destinations.

Beaconing behavior stands out through temporal analysis. Use Zeek's `conn.log` to identify connections occurring at regular intervals - every 60 seconds, every 5 minutes, every hour. Calculate the coefficient of variation for connection timing; low variance suggests automated beaconing rather than human-driven traffic. Long-connection analysis helps too - persistent C2 channels maintain long-duration connections that differ from typical short web requests.

Esoteric C2 channels abuse legitimate services or uncommon protocols. Hunt for traffic to cloud storage APIs (Dropbox, Google Drive, OneDrive) from systems that don't normally use them, unusual use of ICMP for data beyond simple pings, or abuse of protocols like NTP, SMB, or FTP from unexpected sources. Zeek's protocol analyzers can detect protocol violations or unusual implementations.

Connection patterns reveal C2 infrastructure. Hunt for single internal hosts connecting to multiple external IPs on the same ports (fast-flux C2 rotating through infrastructure), or connections to domains that recently changed IP addresses. Rare external connections - destinations contacted by only one or two internal hosts - often indicate C2 rather than legitimate services used across your organization.

Behavioral analytics enhance detection. Look for data volume anomalies - small regular outbound transfers suggesting command receipt, or large inbound data suggesting tasking or tool downloads. Hunt for connections outside business hours from workstations that should be idle, or network activity from servers that don't normally initiate external connections.

Proxy and VPN tunneling for C2 appears through unusual proxy usage patterns, connections to anonymous VPN services, or Tor exit node communications. Zeek can identify SOCKS proxy traffic, unusual tunneling protocols, or encrypted connections within encrypted connections (double encryption).

**However, the challenge is encrypted traffic and legitimate services**. Most web traffic is HTTPS, hiding C2 within. Cloud services are ubiquitous, making abuse harder to spot. Effective hunting requires strong baselines of normal network behavior, understanding which services your organization uses, and focusing on anomalies - unusual timing, rare destinations, behavioral deviations, and correlation with endpoint indicators.







---
[|TOC|]({{< ref "../../../thrunt/_index.md" >}})
[|PREV|]({{< ref "./12_collect.md" >}})
[|NEXT|]({{< ref "./14_exfil.md" >}})

